# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-05-26 15:13:00
"""
import arcpy
from sys import argv

def SocialSubindexSetup(Sports_Recreation_Leisure_employment2020_clipped_="Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_", pop_census_districts_clipped_="Pressure Index variables\\pop_census_districts_clipped_", hotels_clipped_="Social SubIndex Variables\\hotels_clipped_", airports_public_clipped_="Social SubIndex Variables\\airports_public_clipped_", hotels_join="G:\\Brazil_SCI\\Brazil_SCI.gdb\\hotels_join", airports_join="G:\\Brazil_SCI\\Brazil_SCI.gdb\\airports_join", employment_join="G:\\Brazil_SCI\\Brazil_SCI.gdb\\employment_join", social_5km_buffer="social_5km_buffer"):  # SocialSubindexSetup

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    Field_Type = "DOUBLE"
    Field_Map = "id \"id\" true true false 4 Long 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,id,-1,-1;region \"region\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,region,0,8000;zone \"zone\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,zone,0,8000;name \"name\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,name,0,8000;lat \"lat\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,lat,-1,-1;long \"long\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,long,-1,-1;quality \"quality\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,quality,0,8000;frequency \"frequency\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,frequency,0,8000;direction \"direction\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,direction,0,8000;type \"type\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,type,0,8000;experience \"experience\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,experience,0,8000;numerical_direction \"numerical_direction\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,numerical_direction,-1,-1;numerical_frequency \"numerical_frequency\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,numerical_frequency,-1,-1;numerical_experience \"numerical_experience\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,numerical_experience,-1,-1;numerical_quality \"numerical_quality\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,numerical_quality,-1,-1;BUFF_DIST \"BUFF_DIST\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,BUFF_DIST,-1,-1;ORIG_FID \"ORIG_FID\" true true false 4 Long 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,ORIG_FID,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,Shape_Length,-1,-1,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\social_5km_buffer,Shape_Area,-1,-1,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,Shape_Area,-1,-1;CD_MUN \"CD_MUN\" true true false 7 Text 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,CD_MUN,0,7;NM_MUN \"NM_MUN\" true true false 60 Text 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,NM_MUN,0,60;SIGLA \"SIGLA\" true true false 2 Text 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,SIGLA,0,2;CNAE \"CNAE\" true true false 254 Text 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,CNAE,0,254;Units \"Units\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,Units,-1,-1;People \"People\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,People,-1,-1;F2010 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010,-1,-1;SLR_employment_per_capita \"SLR_employment_per_capita\" true true false 8 Double 0 0,Mean,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,SLR_employment_per_capita,-1,-1;F2010_1 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_1,-1,-1;F2010_12 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12,-1,-1;F2010_12_13 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13,-1,-1;F2010_12_13_14 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14,-1,-1;F2010_12_13_14_15 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15,-1,-1;F2010_12_13_14_15_16 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15_16,-1,-1;F2010_12_13_14_15_16_17 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15_16_17,-1,-1;F2010_12_13_14_15_16_17_18 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15_16_17_18,-1,-1;F2010_12_13_14_15_16_17_18_19 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15_16_17_18_19,-1,-1;F2010_12_13_14_15_16_17_18_19_20 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15_16_17_18_19_20,-1,-1;F2010_12_13_14_15_16_17_18_19_20_21 \"F2010\" true true false 8 Double 0 0,First,#,Social SubIndex Variables\\Sports_Recreation_Leisure_employment2020_clipped_,F2010_12_13_14_15_16_17_18_19_20_21,-1,-1"

    # Process: Join Field (Join Field) (management)
    SLR_pop_joined = arcpy.management.JoinField(in_data=Sports_Recreation_Leisure_employment2020_clipped_, in_field="CD_MUN", join_table=pop_census_districts_clipped_, join_field="CD_MUN", fields=["F2010"])[0]

    # Process: Calculate Field (Calculate Field) (management)
    Sports_Recreation_Leisure_employment2020_clipped_2_ = arcpy.management.CalculateField(in_table=SLR_pop_joined, field="SLR_employment_per_capita", expression="!People! / !F2010!", expression_type="PYTHON3", code_block="", field_type=Field_Type)[0]

    # Process: Employment Spatial Join (Spatial Join) (analysis)
    arcpy.analysis.SpatialJoin(target_features=social_5km_buffer, join_features=Sports_Recreation_Leisure_employment2020_clipped_2_, out_feature_class=employment_join, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping=Field_Map, match_option="INTERSECT", search_radius="", distance_field_name="")

    # Process: Airports Spatial Join (Spatial Join) (analysis)
    arcpy.analysis.SpatialJoin(target_features=social_5km_buffer, join_features=airports_public_clipped_, out_feature_class=airports_join, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="", match_option="INTERSECT", search_radius="", distance_field_name="")

    # Process: Hotels Spatial Join (Spatial Join) (analysis)
    arcpy.analysis.SpatialJoin(target_features=social_5km_buffer, join_features=hotels_clipped_, out_feature_class=hotels_join, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="", match_option="INTERSECT", search_radius="", distance_field_name="")

    return Sports_Recreation_Leisure_employment2020_clipped_2_

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"G:\Brazil_SCI\Brazil_SCI.gdb", workspace=r"G:\Brazil_SCI\Brazil_SCI.gdb"):
        SocialSubindexSetup(*argv[1:])
