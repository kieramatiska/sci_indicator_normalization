# -*- coding: utf-8 -*-
"""
Generated by ArcGIS ModelBuilder on : 2023-05-26 15:10:09
"""
import arcpy
from sys import argv

def PressureIndexSetup(pop_census_districts_clipped_="Pressure Index variables\\pop_census_districts_clipped_", population="G:\\Brazil_SCI\\Brazil_SCI.gdb\\population", built_area="G:\\Brazil_SCI\\Brazil_SCI.gdb\\built_area", built_area_clipped_="Pressure Index variables\\built_area_clipped_", roads_clipped_="Pressure Index variables\\roads_clipped_", human_modification_index_clipped_="Pressure Index variables\\human_modification_index_clipped_", roads="G:\\Brazil_SCI\\Brazil_SCI.gdb\\roads", human_modification="G:\\Brazil_SCI\\Brazil_SCI.gdb\\ZonalSt_pressur1", ports="G:\\Brazil_SCI\\Brazil_SCI.gdb\\ports", Ports_MINFRA_2021_clipped_="Pressure Index variables\\ports_clipped_\\Ports_MINFRA_2021_clipped_", pressure_5km_buffer_3_="pressure_5km_buffer", pressure_5km_buffer="pressure_5km_buffer"):  # PressureIndexSetup

    # To allow overwriting outputs change overwriteOutput option to True.
    arcpy.env.overwriteOutput = False

    # Check out any necessary licenses.
    arcpy.CheckOutExtension("spatial")
    arcpy.CheckOutExtension("ImageExt")
    arcpy.CheckOutExtension("ImageAnalyst")

    arcpy.ImportToolbox(r"c:\program files\arcgis\pro\Resources\ArcToolbox\toolboxes\Analysis Tools.tbx")
    Field_Type = "DOUBLE"
    Field_Map = "id \"id\" true true false 4 Long 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,id,-1,-1;region \"region\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,region,0,8000;zone \"zone\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,zone,0,8000;name \"name\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,name,0,8000;lat \"lat\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,lat,-1,-1;long \"long\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,long,-1,-1;quality \"quality\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,quality,0,8000;frequency \"frequency\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,frequency,0,8000;direction \"direction\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,direction,0,8000;type \"type\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,type,0,8000;experience \"experience\" true true false 8000 Text 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,experience,0,8000;numerical_direction \"numerical_direction\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,numerical_direction,-1,-1;numerical_frequency \"numerical_frequency\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,numerical_frequency,-1,-1;numerical_experience \"numerical_experience\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,numerical_experience,-1,-1;numerical_quality \"numerical_quality\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,numerical_quality,-1,-1;BUFF_DIST \"BUFF_DIST\" true true false 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,BUFF_DIST,-1,-1;ORIG_FID \"ORIG_FID\" true true false 4 Long 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,ORIG_FID,-1,-1;Shape_Length \"Shape_Length\" false true true 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,Shape_Length,-1,-1,Pressure Index variables\\pop_census_districts_clipped_,Shape_Length,-1,-1;Shape_Area \"Shape_Area\" false true true 8 Double 0 0,First,#,G:\\Brazil_SCI\\Brazil_SCI.gdb\\pressure_5km_buffer,Shape_Area,-1,-1,Pressure Index variables\\pop_census_districts_clipped_,Shape_Area,-1,-1;CD_MUN \"CD_MUN\" true true false 7 Text 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,CD_MUN,0,7;NM_MUN \"NM_MUN\" true true false 60 Text 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,NM_MUN,0,60;SIGLA \"SIGLA\" true true false 2 Text 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,SIGLA,0,2;AREA_KM2 \"AREA_KM2\" true true false 8 Double 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,AREA_KM2,-1,-1;F1970 \"F1970\" true true false 8 Double 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,F1970,-1,-1;F1980 \"F1980\" true true false 8 Double 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,F1980,-1,-1;F1991 \"F1991\" true true false 8 Double 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,F1991,-1,-1;F2000 \"F2000\" true true false 8 Double 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,F2000,-1,-1;F2010 \"F2010\" true true false 8 Double 0 0,First,#,Pressure Index variables\\pop_census_districts_clipped_,F2010,-1,-1;pop_change \"pop_change\" true true false 8 Double 0 0,Mean,#,Pressure Index variables\\pop_census_districts_clipped_,pop_change,-1,-1"
    Field_Type_2_ = "DOUBLE"

    # Process: Population Change Calculate Field (Calculate Field) (management)
    pop_change = arcpy.management.CalculateField(in_table=pop_census_districts_clipped_, field="pop_change", expression="$feature.F2010 - $feature.F2000", expression_type="ARCADE", code_block="", field_type=Field_Type)[0]

    # Process: Ave Pop Change Spatial Join (Spatial Join) (analysis)
    ave_pop_change_buffer = "G:\\Brazil_SCI\\Brazil_SCI.gdb\\population"
    arcpy.analysis.SpatialJoin(target_features=pressure_5km_buffer, join_features=pop_change, out_feature_class=ave_pop_change_buffer, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping=Field_Map, match_option="INTERSECT", search_radius="", distance_field_name="")

    # Process: Ave Pop Change Calculate Field (Calculate Field) (management)
    population = arcpy.management.CalculateField(in_table=ave_pop_change_buffer, field="pop_change", expression="if ($feature.pop_change < 0) {
return 0
}
else {
return $feature.pop_change
}", expression_type="ARCADE", code_block="", field_type=Field_Type_2_)[0]

    # Process: Built Area Summarize Within (Summarize Within) (analysis)
    Output_Grouped_Table = ""
    arcpy.analysis.SummarizeWithin(in_polygons=pressure_5km_buffer, in_sum_features=built_area_clipped_, out_feature_class=built_area, keep_all_polygons="KEEP_ALL", sum_fields=[], sum_shape="ADD_SHAPE_SUM", shape_unit="SQUAREKILOMETERS", group_field="", add_min_maj="NO_MIN_MAJ", add_group_percent="NO_PERCENT", out_group_table=Output_Grouped_Table)

    # Process: Roads Summarize Within (Summarize Within) (analysis)
    Output_Grouped_Table_2_ = ""
    arcpy.analysis.SummarizeWithin(in_polygons=pressure_5km_buffer_3_, in_sum_features=roads_clipped_, out_feature_class=roads, keep_all_polygons="KEEP_ALL", sum_fields=[], sum_shape="ADD_SHAPE_SUM", shape_unit="KILOMETERS", group_field="", add_min_maj="NO_MIN_MAJ", add_group_percent="NO_PERCENT", out_group_table=Output_Grouped_Table_2_)

    # Process: Human Modification Zonal Statistics as Table (Zonal Statistics as Table) (sa)
    arcpy.sa.ZonalStatisticsAsTable(in_zone_data=pressure_5km_buffer_3_, zone_field="id", in_value_raster=human_modification_index_clipped_, out_table=human_modification, ignore_nodata="DATA", statistics_type="MEAN", process_as_multidimensional="CURRENT_SLICE", percentile_values=90)
    .save(Human_Modification_Zonal_Statistics_as_Table)


    # Process: Spatial Join (Spatial Join) (analysis)
    arcpy.analysis.SpatialJoin(target_features=pressure_5km_buffer, join_features=Ports_MINFRA_2021_clipped_, out_feature_class=ports, join_operation="JOIN_ONE_TO_ONE", join_type="KEEP_ALL", field_mapping="", match_option="INTERSECT", search_radius="", distance_field_name="")

if __name__ == '__main__':
    # Global Environment settings
    with arcpy.EnvManager(scratchWorkspace=r"G:\Brazil_SCI\Brazil_SCI.gdb", workspace=r"G:\Brazil_SCI\Brazil_SCI.gdb"):
        PressureIndexSetup(*argv[1:])
