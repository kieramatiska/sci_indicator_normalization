---
title: "Results Visualization"
author: "Kort Alexander"
date: "2023-02-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(here)
```

# Data input and wrangling

```{r}
surf_spots <- read_csv(here("data", "surf_spot_states", "surf_spot_states.csv"))
sci_w_climate_10km <- read_csv(here("sci_w_climate.csv")) %>% 
  select(id, sci)

# join sci to surf spots using id
surf_spots <- left_join(surf_spots, sci_w_climate_10km, by = "id", keep = FALSE)

# filter for each region
surf_spots_nne <- surf_spots %>% 
  filter(region == "Norte" | region == "Nordeste")
surf_spots_se <- surf_spots %>% 
  filter(region == "Sudeste")
surf_spots_s <- surf_spots %>% 
  filter(region == "Sul")
```

# Visualization

```{r}
# make histograms for all of Brazil and each region
ggplot(data = surf_spots, aes(x = sci)) +
  geom_histogram(breaks = c(0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1), fill = c("#d7191c", "#d7191c", "#fdae61", "#fdae61", "#a6d96a", "#a6d96a", "#1a9641", "#1a9641")) +
  labs(x = "SCI", y = "Number of spots") +
  theme_minimal()
ggplot(data = surf_spots_nne, aes(x = sci)) +
  geom_histogram(breaks = c(0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1), fill = c("#d7191c", "#d7191c", "#fdae61", "#fdae61", "#a6d96a", "#a6d96a", "#1a9641", "#1a9641")) +
  scale_y_continuous(limits = c(0, 60)) +
  labs(x = "SCI", y = "Number of spots") +
  theme_minimal()
ggplot(data = surf_spots_se, aes(x = sci)) +
  geom_histogram(breaks = c(0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1), fill = c("#d7191c", "#d7191c", "#fdae61", "#fdae61", "#a6d96a", "#a6d96a", "#1a9641", "#1a9641")) +
  scale_y_continuous(limits = c(0, 60)) +
  labs(x = "SCI", y = "Number of spots") +
  theme_minimal()
ggplot(data = surf_spots_s, aes(x = sci)) +
  geom_histogram(breaks = c(0, 0.125, 0.25, 0.375, 0.5, 0.625, 0.75, 0.875, 1), fill = c("#d7191c", "#d7191c", "#fdae61", "#fdae61", "#a6d96a", "#a6d96a", "#1a9641", "#1a9641")) +
  scale_y_continuous(limits = c(0, 60)) +
  labs(x = "SCI", y = "Number of spots") +
  theme_minimal()
```

